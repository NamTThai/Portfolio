<script>

  'use strict';

  document.addEventListener('WebComponentsReady', function() {

  });

  var eventListener = document.querySelector('#eventListener');
  eventListener.addEventListener('dom-change', function() {

  });

  eventListener.navigationbarScrollHandler = function(event) {
    _onWelcomeEnd();

    var scroller = event.detail.target;
    if (scroller.scrollTop != 0) {
      _colapseHeader();
      document.querySelector("#scrollToTop").style.display = "block";
    } else {
      _expandHeader();
      document.querySelector("#scrollToTop").style.display = "none";
    }
  }

  eventListener.scrollToTop = function() {
    var scroller = document.querySelector("#headerPanel").scroller;
    $(scroller).animate({scrollTop: 0}, "slow");
  }

  eventListener.featureToggle = function(event) {
    var header = event.target.parentElement;
    var card = header.parentElement;
    var collapseContent = card.querySelector(".featureCollapse");
    collapseContent.toggle();

    // Animating the navigation Fab icon
    if (collapseContent.opened) {
      var navFab = document.createElement("paper-fab");
      navFab.icon = "arrow-forward";
      card.appendChild(navFab);
      $(navFab).fadeIn();
    } else {
      var navFab = card.querySelector("paper-fab");
      $(navFab).fadeOut(function(){
        this.remove();
      });
    }
  }

  eventListener.reroute = function(event) {
    _scrollToSection(event.target.parentNode.getAttribute("hash"));
  }

  eventListener.reroutePanel = function(event) {
    document.querySelector("#mainDrawerPanel").closeDrawer();
    _scrollToSection(event.target.getAttribute("hash"));
  }

  eventListener.triggerDrawer = function() {
    console.log("toggle");
  }

  function _colapseHeader() {
    document.querySelector("#headerNavigation").classList.remove("tallHeader");
  }

  function _expandHeader() {
    if (!window.matchMedia("only screen and (max-width:640px)").matches) {
      document.querySelector("#headerNavigation").classList.add("tallHeader");
    }
  }

  function _scrollToSection(section) {
    _colapseHeader();
    var scroller = document.querySelector("#headerPanel").scroller;
    var currentScroll = $(String(section)).position().top;
    var firstScroll = $("#features").position().top;
    var scrollVal = currentScroll - firstScroll;
    $(scroller).animate({scrollTop: scrollVal}, {
      easing: "swing",
      done: function() {
        window.location.hash = section;
      }
    });
  }

</script>
